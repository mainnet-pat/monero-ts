"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = void 0;var _TestUtils = _interopRequireDefault(require("./TestUtils"));


/**
 * Utility class to run monero-wallet-rpc test servers until terminated.
 */
class RunWalletRpcTestServers {

  static async run() {

    // start monero-wallet-rpc servers
    console.log("Starting monero-wallet-rpc servers...");
    let numProcesses = 10;
    let processPromises = [];
    for (let i = 0; i < numProcesses; i++) {
      processPromises.push(_TestUtils.default.startWalletRpcProcess());
    }
    let wallets = await Promise.all(processPromises);
    console.log("Done starting monero-wallet-rpc servers");

    // close wallets and servers on ctrl+c
    process.on("SIGINT", async function () {
      console.log("Stopping monero-wallet-rpc servers...");
      for (let wallet of wallets) await _TestUtils.default.stopWalletRpcProcess(wallet);
      console.log("Stopped monero-wallet-rpc servers");
      process.exit(0);
    });
  }
}

// run until termination
exports.default = RunWalletRpcTestServers;RunWalletRpcTestServers.run();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVGVzdFV0aWxzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJSdW5XYWxsZXRScGNUZXN0U2VydmVycyIsInJ1biIsImNvbnNvbGUiLCJsb2ciLCJudW1Qcm9jZXNzZXMiLCJwcm9jZXNzUHJvbWlzZXMiLCJpIiwicHVzaCIsIlRlc3RVdGlscyIsInN0YXJ0V2FsbGV0UnBjUHJvY2VzcyIsIndhbGxldHMiLCJQcm9taXNlIiwiYWxsIiwicHJvY2VzcyIsIm9uIiwid2FsbGV0Iiwic3RvcFdhbGxldFJwY1Byb2Nlc3MiLCJleGl0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvdGVzdC91dGlscy9SdW5XYWxsZXRScGNUZXN0U2VydmVycy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVGVzdFV0aWxzIGZyb20gXCIuL1Rlc3RVdGlsc1wiO1xuaW1wb3J0IHsgTW9uZXJvV2FsbGV0UnBjIH0gZnJvbSBcIi4uLy4uLy4uL2luZGV4XCI7XG5cbi8qKlxuICogVXRpbGl0eSBjbGFzcyB0byBydW4gbW9uZXJvLXdhbGxldC1ycGMgdGVzdCBzZXJ2ZXJzIHVudGlsIHRlcm1pbmF0ZWQuXG4gKi9cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJ1bldhbGxldFJwY1Rlc3RTZXJ2ZXJzIHtcbiAgXG4gIHN0YXRpYyBhc3luYyBydW4oKSB7XG4gICAgXG4gICAgLy8gc3RhcnQgbW9uZXJvLXdhbGxldC1ycGMgc2VydmVyc1xuICAgIGNvbnNvbGUubG9nKFwiU3RhcnRpbmcgbW9uZXJvLXdhbGxldC1ycGMgc2VydmVycy4uLlwiKTtcbiAgICBsZXQgbnVtUHJvY2Vzc2VzID0gMTA7XG4gICAgbGV0IHByb2Nlc3NQcm9taXNlczogUHJvbWlzZTxNb25lcm9XYWxsZXRScGM+W10gPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVByb2Nlc3NlczsgaSsrKSB7XG4gICAgICBwcm9jZXNzUHJvbWlzZXMucHVzaChUZXN0VXRpbHMuc3RhcnRXYWxsZXRScGNQcm9jZXNzKCkpO1xuICAgIH1cbiAgICBsZXQgd2FsbGV0cyA9IGF3YWl0IFByb21pc2UuYWxsKHByb2Nlc3NQcm9taXNlcyk7XG4gICAgY29uc29sZS5sb2coXCJEb25lIHN0YXJ0aW5nIG1vbmVyby13YWxsZXQtcnBjIHNlcnZlcnNcIik7XG4gICAgXG4gICAgLy8gY2xvc2Ugd2FsbGV0cyBhbmQgc2VydmVycyBvbiBjdHJsK2NcbiAgICBwcm9jZXNzLm9uKFwiU0lHSU5UXCIsIGFzeW5jIGZ1bmN0aW9uKCkge1xuICAgICAgY29uc29sZS5sb2coXCJTdG9wcGluZyBtb25lcm8td2FsbGV0LXJwYyBzZXJ2ZXJzLi4uXCIpO1xuICAgICAgZm9yIChsZXQgd2FsbGV0IG9mIHdhbGxldHMpIGF3YWl0IFRlc3RVdGlscy5zdG9wV2FsbGV0UnBjUHJvY2Vzcyh3YWxsZXQpO1xuICAgICAgY29uc29sZS5sb2coXCJTdG9wcGVkIG1vbmVyby13YWxsZXQtcnBjIHNlcnZlcnNcIik7XG4gICAgICBwcm9jZXNzLmV4aXQoMCk7XG4gICAgfSk7XG4gIH1cbn1cblxuLy8gcnVuIHVudGlsIHRlcm1pbmF0aW9uXG5SdW5XYWxsZXRScGNUZXN0U2VydmVycy5ydW4oKTtcbiJdLCJtYXBwaW5ncyI6InlMQUFBLElBQUFBLFVBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTs7O0FBR0E7QUFDQTtBQUNBO0FBQ2UsTUFBTUMsdUJBQXVCLENBQUM7O0VBRTNDLGFBQWFDLEdBQUdBLENBQUEsRUFBRzs7SUFFakI7SUFDQUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsdUNBQXVDLENBQUM7SUFDcEQsSUFBSUMsWUFBWSxHQUFHLEVBQUU7SUFDckIsSUFBSUMsZUFBMkMsR0FBRyxFQUFFO0lBQ3BELEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxHQUFHRixZQUFZLEVBQUVFLENBQUMsRUFBRSxFQUFFO01BQ3JDRCxlQUFlLENBQUNFLElBQUksQ0FBQ0Msa0JBQVMsQ0FBQ0MscUJBQXFCLENBQUMsQ0FBQyxDQUFDO0lBQ3pEO0lBQ0EsSUFBSUMsT0FBTyxHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDUCxlQUFlLENBQUM7SUFDaERILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLHlDQUF5QyxDQUFDOztJQUV0RDtJQUNBVSxPQUFPLENBQUNDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsa0JBQWlCO01BQ3BDWixPQUFPLENBQUNDLEdBQUcsQ0FBQyx1Q0FBdUMsQ0FBQztNQUNwRCxLQUFLLElBQUlZLE1BQU0sSUFBSUwsT0FBTyxFQUFFLE1BQU1GLGtCQUFTLENBQUNRLG9CQUFvQixDQUFDRCxNQUFNLENBQUM7TUFDeEViLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLG1DQUFtQyxDQUFDO01BQ2hEVSxPQUFPLENBQUNJLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDakIsQ0FBQyxDQUFDO0VBQ0o7QUFDRjs7QUFFQTtBQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FBQW5CLHVCQUFBLENBQ0FBLHVCQUF1QixDQUFDQyxHQUFHLENBQUMsQ0FBQyJ9